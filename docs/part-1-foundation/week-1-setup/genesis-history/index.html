<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genesis: The First Bitcoin Android App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f5f2eb; color: #2d2a26; }
        h1, h2, h3, .heading-font { font-family: 'Space Grotesk', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: 0 auto; height: 300px; max-height: 400px; }
        .interactive-card { transition: all 0.3s ease; cursor: pointer; border-left: 4px solid transparent; }
        .interactive-card:hover { transform: translateX(5px); border-left-color: #d97706; background-color: #fff8ed; }
        .interactive-card.active { border-left-color: #d97706; background-color: #fff8ed; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .tech-layer { transition: all 0.3s ease; }
        .tech-layer:hover { transform: scale(1.02); }
        .nav-btn { transition: color 0.2s ease; border-bottom: 2px solid transparent; }
        .nav-btn.active { color: #d97706; border-bottom-color: #d97706; }

        /* Custom Scrollbar for panels */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #efebe0; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #d1ccbf; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #b0aba0; }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-[#f5f2eb]/90 backdrop-blur-md border-b border-stone-200">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold heading-font tracking-tight text-stone-800">Genesis<span class="text-amber-600">Wallet</span></span>
                </div>
                <div class="flex items-center gap-6">
                    <div class="hidden md:flex space-x-8">
                        <button onclick="navTo('hero')" class="nav-btn active text-stone-600 hover:text-stone-900 font-medium text-sm">Overview</button>
                        <button onclick="navTo('history')" class="nav-btn text-stone-600 hover:text-stone-900 font-medium text-sm">History</button>
                        <button onclick="navTo('tech')" class="nav-btn text-stone-600 hover:text-stone-900 font-medium text-sm">Tech Stack</button>
                        <button onclick="navTo('impact')" class="nav-btn text-stone-600 hover:text-stone-900 font-medium text-sm">Impact</button>
                        <button onclick="navTo('history-story')" class="nav-btn text-stone-600 hover:text-stone-900 font-medium text-sm">Read the History</button>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-stone-600 hidden lg:inline">Audio</span>
                        <audio controls preload="none" class="h-8">
                            <source src="../../../assets/audio/Schildbach-Wallet-Invented-Mobile-Bitcoin-SPV.mp3" type="audio/mpeg">
                        </audio>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow">

        <!-- HERO SECTION -->
        <section id="hero" class="pt-16 pb-12 sm:pt-24 px-4 bg-gradient-to-b from-[#f5f2eb] to-[#ebe7de]">
            <div class="max-w-4xl mx-auto text-center">
                <div class="inline-block px-3 py-1 mb-4 text-xs font-semibold tracking-wider text-amber-700 uppercase bg-amber-100 rounded-full">
                    The First Successful Android Implementation
                </div>
                <h1 class="text-5xl sm:text-6xl font-bold text-stone-900 mb-6 tracking-tight">
                    "Bitcoin Wallet"
                </h1>
                <p class="text-xl text-stone-600 mb-8 max-w-2xl mx-auto leading-relaxed">
                    In early 2011, Andreas Schildbach released the first decentralized mobile wallet. It didn't just store coins; it proved Bitcoin could exist purely peer-to-peer on a smartphone using <b>SPV technology</b>.
                </p>
                <div class="flex justify-center gap-4">
                    <button onclick="navTo('history')" class="bg-stone-900 text-white px-6 py-3 rounded-lg font-medium hover:bg-stone-700 transition shadow-lg">Explore History</button>
                    <button onclick="navTo('tech')" class="bg-white text-stone-800 border border-stone-300 px-6 py-3 rounded-lg font-medium hover:bg-stone-50 transition shadow-sm">View Architecture</button>
                    <button onclick="navTo('history-story')" class="bg-amber-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-amber-500 transition shadow-sm">Read the History</button>
                </div>
                <p class="mt-4 text-sm text-stone-500">
                    Listen to the audio player in the top right.
                </p>
                <div class="mt-6">
                    <a href="../lesson-2-tools/" class="inline-block bg-white text-stone-800 border border-stone-300 px-6 py-2 rounded-lg font-medium hover:bg-stone-50 transition shadow-sm">Continue to Lesson 2</a>
                </div>
            </div>
        </section>

        <!-- HISTORY TIMELINE -->
        <section id="history" class="py-16 px-4 bg-white border-y border-stone-200">
            <div class="max-w-6xl mx-auto">
                <div class="mb-10 text-center sm:text-left">
                    <h2 class="text-3xl font-bold text-stone-800 mb-4">The Timeline</h2>
                    <p class="text-stone-600 max-w-2xl">
                        Explore the critical milestones of the first Android wallet. Unlike centralized solutions (like the Mt. Gox mobile site), this app ran directly on the Bitcoin network. Click the timeline items to reveal details.
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-12 gap-8">
                    <!-- List -->
                    <div class="md:col-span-4 space-y-3" id="timeline-list">
                        <!-- JS populated -->
                    </div>
                    <!-- Detail View -->
                    <div class="md:col-span-8 bg-[#fbfaf8] rounded-2xl p-8 border border-stone-100 shadow-sm flex flex-col justify-center min-h-[300px]">
                        <div id="timeline-content" class="animate-fade-in">
                            <!-- JS populated -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- TECH STACK ANALYSIS -->
        <section id="tech" class="py-16 px-4 bg-[#f5f2eb]">
            <div class="max-w-6xl mx-auto">
                <div class="mb-12">
                    <h2 class="text-3xl font-bold text-stone-800 mb-4">Under the Hood: The Tech Stack</h2>
                    <p class="text-stone-600 max-w-3xl">
                        Running Bitcoin on 2011 hardware (single-core CPUs, 512MB RAM) was impossible with the standard client. Schildbach utilized a specific Java stack and the "Simplified Payment Verification" (SPV) protocol to make it lightweight.
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">

                    <!-- Interactive Stack Diagram -->
                    <div class="space-y-4">
                        <div class="text-sm font-semibold text-stone-500 uppercase tracking-wider mb-2 pl-1">Application Layers (Click to Inspect)</div>

                        <!-- Layer 1 -->
                        <div onclick="showTechDetail('ui')" class="tech-layer group bg-white border-l-4 border-amber-500 p-6 rounded-r-lg shadow-sm cursor-pointer hover:shadow-md">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h3 class="text-lg font-bold text-stone-800">Presentation Layer (UI)</h3>
                                    <p class="text-sm text-stone-500">Native Android (Java/XML)</p>
                                </div>
                                <div class="text-2xl opacity-20 group-hover:opacity-100 transition">üì±</div>
                            </div>
                        </div>

                        <!-- Layer 2 -->
                        <div onclick="showTechDetail('logic')" class="tech-layer group bg-white border-l-4 border-stone-600 p-6 rounded-r-lg shadow-sm cursor-pointer hover:shadow-md">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h3 class="text-lg font-bold text-stone-800">Business Logic</h3>
                                    <p class="text-sm text-stone-500">Wallet Management & Key Storage</p>
                                </div>
                                <div class="text-2xl opacity-20 group-hover:opacity-100 transition">‚öôÔ∏è</div>
                            </div>
                        </div>

                        <!-- Layer 3 -->
                        <div onclick="showTechDetail('network')" class="tech-layer group bg-stone-800 border-l-4 border-stone-900 p-6 rounded-r-lg shadow-sm cursor-pointer hover:shadow-xl">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h3 class="text-lg font-bold text-white">Network Core (bitcoinj)</h3>
                                    <p class="text-sm text-stone-400">P2P Mesh & SPV Implementation</p>
                                </div>
                                <div class="text-2xl text-white opacity-50 group-hover:opacity-100 transition">üåê</div>
                            </div>
                        </div>
                    </div>

                    <!-- Detail Panel -->
                    <div class="bg-white rounded-xl p-8 border border-stone-200 shadow-lg min-h-[400px]">
                        <div id="tech-detail-content">
                            <!-- Default Content -->
                            <div class="h-full flex flex-col justify-center items-center text-center text-stone-400">
                                <div class="text-4xl mb-4">‚ö°</div>
                                <p>Select a layer on the left to analyze the architecture.</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- THE DEVELOPER & IMPACT -->
        <section id="impact" class="py-16 px-4 bg-white border-t border-stone-200">
            <div class="max-w-6xl mx-auto">
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">

                    <!-- Developer Profile -->
                    <div class="lg:col-span-5">
                        <h2 class="text-2xl font-bold text-stone-800 mb-6">The Developer</h2>
                        <div class="bg-[#f5f2eb] rounded-xl p-6 border border-stone-200">
                            <div class="flex items-center gap-4 mb-4">
                                <div class="w-16 h-16 bg-stone-300 rounded-full flex items-center justify-center text-2xl font-bold text-stone-600">
                                    AS
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-stone-900">Andreas Schildbach</h3>
                                    <p class="text-stone-600 text-sm">Software Developer, Berlin</p>
                                </div>
                            </div>
                            <p class="text-stone-700 leading-relaxed mb-4">
                                A Google engineer at the time, Schildbach wanted to pay for coffee with Bitcoin. Finding no decentralized mobile solution, he built his own.
                            </p>
                            <ul class="space-y-2 text-sm text-stone-600">
                                <li class="flex items-start gap-2">
                                    <span class="text-amber-600 font-bold">‚úì</span> Created the first Android Wallet
                                </li>
                                <li class="flex items-start gap-2">
                                    <span class="text-amber-600 font-bold">‚úì</span> Major contributor to <code>bitcoinj</code>
                                </li>
                                <li class="flex items-start gap-2">
                                    <span class="text-amber-600 font-bold">‚úì</span> Defined the URI scheme for payments
                                </li>
                            </ul>
                            <div class="mt-6 pt-4 border-t border-stone-300 text-xs text-stone-500">
                                License: GPLv3 (Open Source)
                            </div>
                        </div>
                    </div>

                    <!-- Impact Charts -->
                    <div class="lg:col-span-7">
                        <h2 class="text-2xl font-bold text-stone-800 mb-6">Impact & Adoption</h2>
                        <p class="text-stone-600 mb-6">
                            The release of "Bitcoin Wallet" triggered a wave of mobile adoption. By proving SPV worked on mobile, it paved the way for every non-custodial wallet that followed.
                        </p>

                        <div class="bg-white p-4 rounded-xl border border-stone-100 shadow-sm">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-semibold text-stone-700">Estimated Early Mobile Adoption (2011-2013)</h3>
                                <div class="flex gap-2 text-xs">
                                    <span class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-amber-500"></span>Installs</span>
                                    <span class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-stone-400"></span>Forks</span>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="adoptionChart"></canvas>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- LONG HISTORY -->
        <section id="history-story" class="py-16 px-4 bg-[#f5f2eb] border-t border-stone-200">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-stone-900 mb-6">The Genesis of Mobile Bitcoin: The Story of the Schildbach Wallet</h2>
                <p class="text-stone-700 leading-relaxed mb-6">
                    In early 2011, Bitcoin was different. Most people needed a desktop computer, a fast connection, and time to sync a growing blockchain. Paying for coffee was a forum idea, not a daily action.
                </p>
                <p class="text-stone-700 leading-relaxed mb-8">
                    That changed when Andreas Schildbach released "Bitcoin Wallet" for Android. It was the first successful non-custodial mobile wallet. It proved a phone could use Bitcoin without a hosted account.
                </p>

                <h3 class="text-2xl font-bold text-stone-800 mb-4">1. The Historical Context (2011)</h3>
                <p class="text-stone-700 leading-relaxed mb-4">
                    In 2011, flagship Android phones were the Samsung Galaxy S and the Nexus S. They had single-core CPUs and about 512 MB of RAM.
                </p>
                <p class="text-stone-700 leading-relaxed mb-4">
                    A full Bitcoin node required the entire ledger. That was too heavy for a mobile phone. Early mobile efforts were web views of exchanges like Mt. Gox. Users did not control their keys.
                </p>
                <p class="text-stone-700 leading-relaxed mb-8">
                    Schildbach chose a native Android app that spoke peer to peer. That choice set a new standard for mobile wallets.
                </p>

                <h3 class="text-2xl font-bold text-stone-800 mb-4">2. The Tech Stack: The SPV Breakthrough</h3>
                <p class="text-stone-700 leading-relaxed mb-4">
                    The app succeeded because of Simplified Payment Verification, or SPV. SPV let the app verify payments without downloading the full blockchain.
                </p>
                <p class="text-stone-700 leading-relaxed mb-4">
                    The core library was bitcoinj, a Java implementation of the Bitcoin protocol. Mike Hearn created it. Schildbach maintained it and used it for the wallet.
                </p>
                <p class="text-stone-700 leading-relaxed mb-4">
                    SPV downloads block headers only. A block header is 80 bytes. The wallet checks the Merkle root to prove a transaction is in a block without downloading the full block.
                </p>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                    <div class="bg-white border border-stone-200 rounded-lg p-4">
                        <div class="text-sm font-semibold text-stone-500 uppercase tracking-wide mb-1">Storage Impact</div>
                        <div class="text-stone-700">Reduced requirements from gigabytes to megabytes.</div>
                    </div>
                    <div class="bg-white border border-stone-200 rounded-lg p-4">
                        <div class="text-sm font-semibold text-stone-500 uppercase tracking-wide mb-1">Network Impact</div>
                        <div class="text-stone-700">Allowed the app to sync in seconds instead of days.</div>
                    </div>
                </div>

                <h4 class="text-xl font-bold text-stone-800 mb-3">The UI/UX Innovations</h4>
                <p class="text-stone-700 leading-relaxed mb-4">
                    QR codes came from the ZXing library. This created the scan to pay flow that is still standard.
                </p>
                <p class="text-stone-700 leading-relaxed mb-4">
                    NFC tap to pay arrived in late 2011. Few phones supported it, but the idea was ahead of its time.
                </p>
                <p class="text-stone-700 leading-relaxed mb-8">
                    Schildbach also designed the bitcoin: URI scheme handler. It let the wallet open from a link and prefill a payment.
                </p>

                <h3 class="text-2xl font-bold text-stone-800 mb-4">3. The Developer: Andreas Schildbach</h3>
                <p class="text-stone-700 leading-relaxed mb-4">
                    Schildbach was a disciplined software engineer. He released the app under the GPLv3 license, so the code stayed open.
                </p>
                <p class="text-stone-700 leading-relaxed mb-8">
                    He was a primary maintainer of bitcoinj. That library powered early wallets like Multibit and Hive. He also pushed for standards that helped mobile users.
                </p>

                <h3 class="text-2xl font-bold text-stone-800 mb-4">4. Challenges and Controversies</h3>
                <p class="text-stone-700 leading-relaxed mb-4">
                    In 2013, Android had a SecureRandom flaw. It weakened the randomness used to generate private keys.
                </p>
                <p class="text-stone-700 leading-relaxed mb-8">
                    The wallet was vulnerable because it created keys on device. Schildbach shipped an emergency update and handled the issue with transparency.
                </p>

                <h3 class="text-2xl font-bold text-stone-800 mb-4">5. The Legacy: From 2011 to Today</h3>
                <p class="text-stone-700 leading-relaxed mb-4">
                    The wallet is still on the Play Store today. It competes with many others, but its influence is everywhere.
                </p>
                <p class="text-stone-700 leading-relaxed mb-4">
                    The header-first sync model is a direct evolution of SPV in bitcoinj. The bitcoin URI standard is still in use. The wallet proved non-custodial control could be mobile.
                </p>
                <p class="text-stone-700 leading-relaxed mb-8">
                    It made Bitcoin portable and practical. It showed that decentralization could fit in a pocket.
                </p>

                <h3 class="text-2xl font-bold text-stone-800 mb-4">Summary of Technical Specifications</h3>
                <div class="overflow-x-auto bg-white border border-stone-200 rounded-lg mb-2">
                    <table class="min-w-full text-left text-sm">
                        <thead class="bg-stone-100 text-stone-700">
                            <tr>
                                <th class="px-4 py-3 font-semibold">Component</th>
                                <th class="px-4 py-3 font-semibold">Technology</th>
                            </tr>
                        </thead>
                        <tbody class="text-stone-700">
                            <tr class="border-t border-stone-200">
                                <td class="px-4 py-3">Language</td>
                                <td class="px-4 py-3">Java (Native Android)</td>
                            </tr>
                            <tr class="border-t border-stone-200">
                                <td class="px-4 py-3">Network Protocol</td>
                                <td class="px-4 py-3">SPV (Simplified Payment Verification)</td>
                            </tr>
                            <tr class="border-t border-stone-200">
                                <td class="px-4 py-3">Key Library</td>
                                <td class="px-4 py-3">bitcoinj</td>
                            </tr>
                            <tr class="border-t border-stone-200">
                                <td class="px-4 py-3">Database</td>
                                <td class="px-4 py-3">SQLite (for transaction metadata)</td>
                            </tr>
                            <tr class="border-t border-stone-200">
                                <td class="px-4 py-3">Security</td>
                                <td class="px-4 py-3">On-device encryption (AES)</td>
                            </tr>
                            <tr class="border-t border-stone-200">
                                <td class="px-4 py-3">License</td>
                                <td class="px-4 py-3">GPLv3 (Open Source)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-stone-900 text-stone-400 py-8 px-4 mt-auto">
        <div class="max-w-6xl mx-auto text-center text-sm">
            <p class="mb-2">Generated for Educational Purposes</p>
            <p class="opacity-60">Source Data: Public repositories, Bitcointalk archives (2011-2012), Google Code history.</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- DATA STORE ---
        const historyData = [
            {
                id: 1,
                date: "Jan 2011",
                title: "Initial Release",
                content: "Andreas Schildbach publishes 'Bitcoin Wallet' to the Android Market (now Play Store). It is the first fully decentralized mobile client. Unlike other attempts that just showed a website view of a centralized exchange, this app held the private keys directly on the phone's storage."
            },
            {
                id: 2,
                date: "Mar 2011",
                title: "QR Code Integration",
                content: "The addition of QR code scanning using the ZXing ('Zebra Crossing') library was a game changer. It established the 'scan-to-pay' UX pattern that became the global standard for crypto payments. Before this, users had to copy-paste impossible strings of characters."
            },
            {
                id: 3,
                date: "June 2011",
                title: "NFC Experiments",
                content: "Schildbach was extremely forward-looking. He implemented NFC (Near Field Communication) support, allowing users to tap phones to exchange Bitcoin addresses. This was years before Apple Pay or Google Pay mainstreamed tap-to-pay."
            },
            {
                id: 4,
                date: "Late 2011",
                title: "Exchange Integration",
                content: "Features were added to display fiat exchange rates directly in the wallet, pulling data from early exchanges. This helped users understand the real-world value of their holdings as volatility increased."
            },
            {
                id: 5,
                date: "2012",
                title: "Bluetooth Offline Pay",
                content: "Development continued with features like Bluetooth payments, allowing transactions to be constructed even when internet connectivity was spotty, a crucial feature for p2p cash scenarios."
            }
        ];

        const techDetails = {
            ui: {
                title: "Android Presentation Layer",
                stack: ["Java Views", "Fragments (Later)", "ZXing Library"],
                desc: "Built using standard Android Activities. The key innovation here was the <b>Intent system</b>. Schildbach designed the app to listen for 'bitcoin:' links, allowing web browsers to trigger the wallet app automatically.",
                features: ["QR Scanner integration", "Address Book", "Transaction History List", "PIN Protection"]
            },
            logic: {
                title: "Business Logic & Storage",
                stack: ["SQLite (Metadata)", "File System (Keys)", "Event Bus"],
                desc: "This layer handled the crucial security. Private keys were stored in a `wallet.dat` compatible format, encrypted on the device's internal storage. It managed the creation of change addresses to preserve privacy.",
                features: ["Key Serialization", "Transaction Builder", "Fee Estimation", "Backup/Restore (Mnemonic came later)"]
            },
            network: {
                title: "The Core: bitcoinj",
                stack: ["SPV Protocol", "Bloom Filters", "P2P Mesh"],
                desc: "The magic sauce. Written by Mike Hearn and Schildbach. <b>bitcoinj</b> implements the Bitcoin protocol in Java. Crucially, it uses <b>SPV (Simplified Payment Verification)</b>. Instead of downloading the 50GB+ blockchain, it only downloads block headers (80 bytes each) and requests only relevant transactions from peers.",
                features: ["Peer Discovery", "Block Header Verification", "Merkle Branch Validation", "Bloom Filtering"]
            }
        };

        // --- STATE MANAGEMENT ---
        let currentTimelineId = 1;

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            renderTimelineList();
            updateTimelineContent(1);
            initChart();
        });

        // --- NAVIGATION LOGIC ---
        function navTo(id) {
            const element = document.getElementById(id);
            if (element) {
                const offset = 80; // height of sticky header
                const bodyRect = document.body.getBoundingClientRect().top;
                const elementRect = element.getBoundingClientRect().top;
                const elementPosition = elementRect - bodyRect;
                const offsetPosition = elementPosition - offset;

                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });
            }

            // Update active state
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // --- TIMELINE LOGIC ---
        function renderTimelineList() {
            const container = document.getElementById('timeline-list');
            container.innerHTML = historyData.map(item => `
                <div onclick="updateTimelineContent(${item.id})"
                     class="interactive-card bg-white p-4 rounded-lg shadow-sm mb-3 ${item.id === currentTimelineId ? 'active' : ''}"
                     id="timeline-btn-${item.id}">
                    <div class="text-xs font-bold text-amber-600 uppercase tracking-wide">${item.date}</div>
                    <div class="font-bold text-stone-800">${item.title}</div>
                </div>
            `).join('');
        }

        function updateTimelineContent(id) {
            currentTimelineId = id;

            // Update visual active state
            document.querySelectorAll('.interactive-card').forEach(el => el.classList.remove('active'));
            document.getElementById(`timeline-btn-${id}`).classList.add('active');

            // Update Content
            const data = historyData.find(d => d.id === id);
            const contentDiv = document.getElementById('timeline-content');

            contentDiv.style.opacity = '0';
            setTimeout(() => {
                contentDiv.innerHTML = `
                    <div class="flex items-center gap-3 mb-4">
                        <span class="text-4xl text-stone-300 font-bold">0${data.id}</span>
                        <h3 class="text-2xl font-bold text-stone-800">${data.title}</h3>
                    </div>
                    <div class="prose prose-stone text-stone-600 leading-relaxed">
                        ${data.content}
                    </div>
                `;
                contentDiv.style.opacity = '1';
            }, 200);
        }

        // --- TECH STACK LOGIC ---
        function showTechDetail(layerKey) {
            const data = techDetails[layerKey];
            const container = document.getElementById('tech-detail-content');

            container.innerHTML = `
                <div class="animate-fade-in text-left">
                    <h3 class="text-2xl font-bold text-amber-700 mb-2">${data.title}</h3>
                    <div class="flex flex-wrap gap-2 mb-6">
                        ${data.stack.map(s => `<span class="px-2 py-1 bg-stone-100 text-stone-600 text-xs rounded border border-stone-200 font-mono">${s}</span>`).join('')}
                    </div>
                    <p class="text-stone-700 mb-6 leading-relaxed border-b border-stone-100 pb-6">
                        ${data.desc}
                    </p>
                    <h4 class="font-bold text-stone-800 mb-3 text-sm uppercase tracking-wide">Key Capabilities</h4>
                    <ul class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                        ${data.features.map(f => `<li class="flex items-center gap-2 text-sm text-stone-600"><span class="w-1.5 h-1.5 bg-amber-500 rounded-full"></span>${f}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        // --- CHART LOGIC ---
        function initChart() {
            const ctx = document.getElementById('adoptionChart').getContext('2d');

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan 2011', 'Jun 2011', 'Jan 2012', 'Jun 2012', 'Jan 2013'],
                    datasets: [
                        {
                            label: 'Active Installs (Est.)',
                            data: [100, 1500, 8000, 25000, 60000],
                            borderColor: '#d97706',
                            backgroundColor: 'rgba(217, 119, 6, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'GitHub Forks/Derivatives',
                            data: [0, 5, 20, 50, 120],
                            borderColor: '#78716c',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: { family: "'Inter', sans-serif" }
                            }
                        },
                        tooltip: {
                            backgroundColor: '#2d2a26',
                            titleFont: { family: "'Space Grotesk', sans-serif" },
                            bodyFont: { family: "'Inter', sans-serif" },
                            padding: 10,
                            displayColors: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#f5f5f4'
                            },
                            ticks: {
                                font: { family: "'Inter', sans-serif", size: 10 }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: { family: "'Inter', sans-serif", size: 10 }
                            }
                        }
                    }
                }
            });
        }

    </script>
</body>
</html>
